<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    Tag: Training
  
</title>

<meta property="og:type" content="website">
<meta property="og:title" content="Stefano Cianciulli">
<meta property="og:url" content="https://cianciustyles.github.io/tags/Training/index.html">
<meta property="og:site_name" content="Stefano Cianciulli">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Stefano Cianciulli">
<meta name="twitter:card" content="summary">


  <link rel="alternative" href="/atom.xml" title="Stefano Cianciulli" type="application/atom+xml">



  <link rel="icon" href="/favicon.png">



<link rel="stylesheet" href="/perfect-scrollbar/css/perfect-scrollbar.min.css">


<link rel="stylesheet" href="/styles/main.css">







<meta name="generator" content="Hexo 7.1.1"></head>
<body
  
    class="monochrome"
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/">Stefano Cianciulli</a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/">Stefano Cianciulli</a></h1>
    
      <p class="subtitle">
        Life (and programming) as seen thru my lens
      </p>
    
    <div class="info">
      <div class="content">
        
        
          <div class="author">Stefano Cianciulli</div>
        
      </div>
      
        <div class="avatar">
          
            <a href="/About-Me"><img src="https://i.imgur.com/LznrOet.jpeg"></a>
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li>
                <a href="/" title="Homepage" external="false">Homepage</a>
              </li>
            
          
            
              <li>
                <a href="/About-Me" title="About Me" external="false">About Me</a>
              </li>
            
          
            
              <li>
                <a href="/now" title="What I&#39;m Doing Now" external="false">What I&#39;m Doing Now</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li class="tag-list-container">
                <a href="javascript:;">Tag</a>
                <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWS/" rel="tag">AWS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Clean-Code/" rel="tag">Clean Code</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/" rel="tag">Django</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/London/" rel="tag">London</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/My-Notes/" rel="tag">My Notes</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Open-Source/" rel="tag">Open Source</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Security/" rel="tag">Security</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Seminars/" rel="tag">Seminars</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Training/" rel="tag">Training</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Uncle-Bob/" rel="tag">Uncle Bob</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a><span class="tag-list-count">1</span></li></ul>
              </li>
            
          
            
              <li class="archive-list-container">
                <a href="javascript:;">Archive</a>
                <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">1</span></li></ul>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="https://github.com/CianciuStyles" title="Github" target="_blank" rel="noopener">Github</a>
              </li>
            
          
            
              <li>
                <a href="https://it.linkedin.com/in/stefanocianciulli" title="LinkedIn" target="_blank" rel="noopener">LinkedIn</a>
              </li>
            
          
        </ul>
      
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 1000px">
      
          <h1>Training</h1>


  
  
    <div class="post-list">
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2017/11/29/Advanced-Web-Application-Security-Training/" >
  Advanced Web Application Security Training
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2017/11/29/Advanced-Web-Application-Security-Training/"><span class="article-date">
  2017/11/29
</span>
</a>
        

        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Security/" rel="tag">Security</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Training/" rel="tag">Training</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>In September I had the opportunity to attend a two-day training about security in web applications held by <a target="_blank" rel="noopener" href="https://securitum.pl/">Securitum</a>. I thought it would have been an excellent opportunity to gain some more insight on the best practices to follow while working on the Django web application around which my job revolves every day.</p>
<p>The training was structured in sections, one for each of the several vulnerabilities we analysed, where each section was opened by a theoretical explanation and later followed by a “hands-on” exercise where we were required to exploit the flaw we had just learned about in order to bypass the security of a fictional system and gain access to some information we should not have been able to reach.</p>
<p>Among the vulnerabilities I learned about during the training, I was particularly struck by the <a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing">XML External Entity</a> one. If you are not familiar with this, it basically revolves around the possibility offered by XML to define your own entities in documents, like in the following code fragment:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span></span><br><span class="line">  <span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [  </span></span><br><span class="line"><span class="meta">   <span class="meta">&lt;!ELEMENT <span class="keyword">foo</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta">   <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///dev/random&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">foo</span>&gt;</span></span><br><span class="line">    <span class="symbol">&amp;xxe;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The possible values after the <code>SYSTEM</code> keyword can be:</p>
<ul>
<li>a file on the server, whose contents will replace the entity;</li>
<li>a directory on the server, whose file listing will replace the entity;</li>
<li>an HTTP request, whose response will replace the entity.</li>
</ul>
<p>Since most of the XML parsers have the option for parsing and resolving external entities activated by default, it could be an easy attack vector for getting the contents of some file or service we should not be able to access remotely, as in the screenshot below:</p>
<img src="/2017/11/29/Advanced-Web-Application-Security-Training/xxe.png" class="" title="XXE vulnerability in Burp Suite Free">

<p>Another vulnerability we analysed is the famous <a target="_blank" rel="noopener" href="https://docs.python.org/2/library/pickle.html">pickle</a> module in Python. This module is able to serialise and deserialise Python objects as byte streams using a specific stack-based language: basically the output of the <code>pickle</code> operation is a program which is then able to recreate the serialised Python data structures. In this case, the problem arises when an attacker is able to modify the representation of a pickled object to inject code that gets executed remotely when Pickle deserialises the object. For example, in the code fragment below we are telling Python to call the <code>os.system</code> function with <code>echo hello world</code> as a parameter, which will print the string <code>hello world</code> on the server:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cos</span><br><span class="line">system</span><br><span class="line">(S&#x27;echo hello world&#x27;</span><br><span class="line">tR.</span><br></pre></td></tr></table></figure>

<p>The last vulnerability is a variation of the <a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/faq/fundamentals/#javascript">NoSQL injection affecting MongoDB</a>, which allows you to run arbitrary JavaScript code on the server for some of its operations (e.g., in the <code>$where</code> clause in a query). This obviously can be used as a vector attack for accessing records we should not have access to. For example, if on the server we have this code for querying the users table in our database</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="property">myCollection</span>.<span class="title function_">find</span>(&#123; <span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">$where</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> obj.<span class="property">username</span> == $user &amp;&amp; obj.<span class="property">password</span> == $pass; &#125; &#125;);</span><br></pre></td></tr></table></figure>

<p>and we send a request to the server formatted as following</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.example.com/query?user=&quot;admin&quot;;&#125;&#125;);//&amp;pass=</span><br></pre></td></tr></table></figure>

<p>this gets translated in MongoDB as the following query</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="property">myCollection</span>.<span class="title function_">find</span>(&#123; <span class="attr">active</span>: <span class="literal">true</span>, <span class="attr">$where</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> obj.<span class="property">username</span> == <span class="string">&quot;admin&quot;</span>;&#125;&#125;);<span class="comment">// &amp;&amp; obj.password == &quot;&quot; ; &#125; &#125;);</span></span><br></pre></td></tr></table></figure>

<p>which could possibly allow us to login as the ‘admin’ user (if there is one in the table).</p>

        
      </div>
    </div>

  
    </div>
  






          <div class="main-footer">
  
    © 2024 Stefano Cianciulli - Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>

      
        </div>
      
    </div>
  </div>
  
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>


  
<link rel="stylesheet" href="/PhotoSwipe/photoswipe.css">

  
<link rel="stylesheet" href="/PhotoSwipe/default-skin/default-skin.css">


  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  
<script src="/PhotoSwipe/photoswipe.js"></script>

  
<script src="/PhotoSwipe/photoswipe-ui-default.js"></script>




<script src="/perfect-scrollbar/js/min/perfect-scrollbar.min.js"></script>


<script src="/scripts/main.js"></script>


</body>
</html>
